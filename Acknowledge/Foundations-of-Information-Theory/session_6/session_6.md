---
title: 离散信道及其容量
published: 2026-01-07
description: "信息量基础：离散信道及其容量"
first_level_category: "知识库"
second_level_category: "信息论"
tags: ['信息论']
draft: false
---

## 1. 信道分类

![1](./1.jpg)

### 1.1. 按输入、输出取值划分

![2](./2.jpg)

### 1.2. 按输入集和输出集划分

![3](./3.jpg)

### 1.3. 按信道转移概率性质划分

![4](./4.jpg)

### 1.4. 恒参信道

![5](./5.jpg)

## 2. 离散信道数学模型

离散信道的输入 $X$ 是随机变量，输出 $Y$ 也是随机变量。但是当 $X$ 输入确定时，其等价为一个确知信号。此时输出 $Y$ 也是确知的。

**但由于信道里噪声的干扰，使得 $Y$ 在 $X$ 确知的情况下仍然为随机变量。**
即 
$$
r(t) = x(t)(确知信号) + n(t)(噪声)
$$

所以可以使用**条件概率或转移概率 $P(y|x)$** 来描述 $Y$ 与 $X$ 之间的关系，其中 $x \in X, y \in Y$。信道模型如下：

![6](./6.jpg)

![7](./7.jpg)

**人话**：

定义了一个输入随机变量 $X$，然后 $x$ 是当前时刻的信道输入值。 $Y$ 是信道输出的随机变量， $y$ 是输入为 $x$ 时，信道的输出值。

由于信道只是作为传输媒介（受噪声干扰），因此可用 $Y$ 与 $X$ 的关系去表示信道，由此得到集合：
$$
\{X^N, p(y | x), Y_N\}
$$

### 2.1. 离散无记忆信道

![8](./8.jpg)


即当前时刻的输入$x$只有$x_n$，其他时刻的输入$x_{n-1},x_{n+1}$都和 n 时刻无关（无记忆），因此输出 $y$ 也只有 $x_n$ 的响应 $y_n$。

### 2.2. 平稳/恒参信道

![9](./9.jpg)

即不管是什么时刻的输入（$x_n$还是$x_{n+k}$），只要信道输入的符号是 $a_i$，那么信道的输出**一定是** $y_j$。

### 2.3. 单符号信道

![10](./10.jpg)

![11](./11.jpg)

![11](./12.jpg)

![11](./13.jpg)

**重点**：

![11](./16.jpg)

![11](./14.jpg)

![15](./15.jpg)

![17](./17.jpg)

## 3. 信道容量

### 3.1. 单符号离散信道

![18](./18.jpg)

---

*知识点回顾：平均互信息 $I(X;Y)$*

平均互信息 $I(X;Y)$ 度量的是：当我们知道信源 $X$ 发出的信号后，对信宿 $Y$ 的不确定性平均减少了多少（或者说我们获得了多少关于 $Y$ 的信息）
$$
I(X;Y) = \sum_x P(x) I(x;Y) = \sum_{x,y} P(x)P(y|x) \log \frac{P(y|x)}{P(y)}
$$
这是信息论中最常用的指标。它不再只看某一个 $x$，而是看整个系统。它表示：**传输一次符号，平均能传递多少信息量**

对数项 $\log \frac{P(y|x)}{P(y)}$代表了不确定性的减少程度。

直观理解就是：本来我觉得 $y$ 发生的概率是 $P(y)$，现在你告诉我 $x$ 发生了，我觉得 $y$ 发生的概率变成了 $P(y|x)$。这个对数项度量了“收到 $x$ 后将 $y$ 的猜测修正了多少”

$I(X;Y)$本质上是计算：后验概率与先验概率之比的对数的统计平均值

在通信系统中，它的含义可以总结为以下两种等价的说法（非常重要）：

**1. 不确定性的减少量**：
$$
I(X;Y) = H(Y) - H(Y|X)
$$

*   $H(Y)$：收信者在没收到信号前，对信宿的不确定性
*   $H(Y|X)$：收信者在收到信号 $X$ 后，对信宿仍存留的平均不确定性（即信道噪声带来的干扰）
*   即平均互信息 = 原有的不确定性 - 剩下的不确定性 = **获得的信息量**

**2. 信道容量的基础**：

$I(X;Y)$ 衡量了信道输入 $X$ 和输出 $Y$ 之间的相关性

如果信道是完美的（无噪），$X$ 完全决定 $Y$，互信息最大（等于熵）；如果信道断了（完全噪声），$X$ 和 $Y$ 独立，互信息为 0。

平均互信息就是“后验概率”相对于“先验概率”变化的期望值。

例如：

* $I(X;Y) > 0$：说明只要 $X$ 和 $Y$ 不是完全独立的，知道 $X$ 总能帮我们更准确地预测 $Y$
* $I(X;Y) = 0$：说明 $X$ 和 $Y$ 完全独立（比如你扔骰子，$X$ 是点数，$Y$ 是今天下不下雨），知道 $X$ 对猜测 $Y$ 没有任何帮助

**3. 核心公式**
$$
I(X;Y) = H(Y) - H(Y|X) \\
= H(X) - H(X|Y)(因为 I(X;Y) = I(Y;X))\\
= H(X) + H(Y) - H(XY)
$$

![18](./21.jpg)

![18](./22.jpg)

![18](./23.jpg)

---

### 3.2. 多维矢量信道

![18](./24.jpg)

![25](./25.jpg)

### 3.3. 离散无噪信道容量

![26](./26.jpg)

**1. 无损信道**

![27](./27.jpg)

$H(Y|X)=0$ 意味着当输出 $y$ 确知时， 可确定 $x$ 的取值。（因为一个输出 $y$ 只会对应一个输入值 $x$）

由互信息的性质:
$$
I(X;Y) = H(Y) - H(Y|X) \\
= H(X) - H(X|Y)\\
= H(X) + H(Y) - H(XY)
$$
此时可化简得到 
$$
C = max H(X) = logr
$$
即当输入符号集各符号等概时（信道输入不确定量最大），信道容量达到最大值。

**2. 确定信道**

![27](./28.jpg)

同理，$H(X|Y)=0$ 意味着当输入 $x$ 确知时， 可确定 $y$ 的取值。（因为一个输入 $x$ 只会对应一个输出值 $y$）

**3. 无损确定信道**

![28](./29.jpg)

**总结**：

**因此离散无噪信道的容量为：**
$$
C = log_2\ min(r,s)(bit/symbol)
$$
其中，$r$ 为输入符号集的大小，$s$ 为输出符号集合的大小。

> **注意：** 使用的前提是信道无噪声，即状态概率转移矩阵的元素只有 "0" 和 "1"。

![26](./26.jpg)

- 对图一：$r = 2,\ s = 5$
- 图二：$r = 5,\ s = 2$
- 图三：$r = 3,\ s = 3$

### 3.4. 离散对称信道的容量

若一个信道的转移概率矩阵按 **输出** 可分为若干子集其中每个子集都有如下特性：即每一行是其他行的置换，每一列是其他列的置换，则信道称为对称信道。

> 补充：矩阵的置换
>
> 置换即“重新排列”。
>
> "A 行是 B 行的置换" 等价于 "A 行和 B 行包含的数字（元素）完全一样，只是顺序被打乱了。"
>
> 就像扑克牌，不管怎么洗牌（重新排列），这副牌里的花色和数字总数是不变的。
>
> 假设有一个集合 A：$\{0.7, 0.2, 0.1\}$。
>
> 存在另一个集合 B：$\{0.1, 0.7, 0.2\}$，显然元素相同、顺序不同，因此是矩阵的置换。
> 
> 而另一个集合 C： $\{0.7, 0.3, 0.0\}$ 显然不是（数字变了，0.2 变成了 0.3）

#### **1. 对称信道**

对称信道通常指**广义**对称信道。它的核心在于 “整体行对称，局部列对称” 。

一个信道的转移概率矩阵 $P$，如果满足以下两个条件，则称为对称信道：
1. **行对称**：矩阵的每一行都是其他行的置换（包含的元素集合完全相同）。
2. **列可分组对称**：矩阵的列（输出）可以划分为若干个子集（子矩阵）。在每一个子矩阵内部，每一行是其他行的置换，每一列也是其他列的置换。

**判别方法**：
1. 列求和：对所有的列进行求和。但所有列之和不需要完全相等。
2. 分组：每一列元素之和不等的列必须能被分开。相同的列（元素相同）归为一组，组内的列和必须相等。
3. **特例**：如果某一组只有一列，那么这一列里的所有元素数值必须相等（为了满足该子矩阵内的行置换性质）。

**例子**：
$$
\begin{bmatrix} 0.5 & 0.3 & 0.2 \\ 0.3 & 0.5 & 0.2 \end{bmatrix} 
$$
（前两列一组，第三列单独一组。前两列和为 0.8，第三列和为 0.4。这是对称信道。）

1. 判断行对称：这两行元素相同，只是元素所在的位置不同，因此满足行置换。
2. 判断列对称：
   1. 首先查看每一列的元素，如果有 K 列的所有元素相同，例如例子里的第一列和第二列，那么它们就被归为同一个子集（同一组）
   2. 再对其他列进行同样的处理，直到将矩阵划分为 R 个子集。每个子集里按列划分时，元素相同。例如例子里可划分为两个子集：$S_1=\{第一列,第二列\}，S_2=\{第三列\}$
   3. 遍历所有子集，查看其按行划分时，每一行的元素是否完全相同。如果相同，则为对称信道，如果不同，则为非对称信道。例如例子里可被划分为两个子集，查看 $S_1$ 的行，显然第一行和第二行的元素只是位置不同（满足置换），元素是相同的；查看 $S_2$，发现其为单列矩阵，且第一行元素等于第二行元素，满足置换规则；因此这是一个对称信道。

> ![NOTE]
> 
> 请注意：实际上比较的是每一列的元素是否完全相同，而不是元素之和是否相等。
> 
> 例如：$[0.5, 0.3]$ 和 $[0.4, 0.4]$显然元素之和相等，但是元素不同，因此绝不是对称信道

再看另一个例子：
$$
\begin{bmatrix}
0.5 & 0.3 & 0.2 \\
0.3 & 0.2 & 0.5
\end{bmatrix}
$$
1. 判断行对称：每一行的元素相同，符合置换规则。
2. 按列划分查看每一列的元素，显然每一列的元素都不相同：第一列为 [0.5, 0.3]，第二列为 [0.3, 0.2]，第三列为 [0.2, 0.5]。
   > 相同：每一列的元素相同，例如第一列为 [0.5, 0.3]，第二列为 [0.3, 0.5]。
3. 因此它们各分为一个子集，总共分为三个子集。
4. 查看子集里的元素：第一个子集 [0.5, 0.3]，显然不满足行置换规则，因此这是一个非对称信道。

#### **2. 强对称信道**

强对称信道是对称信道的一种**特例**，也是最理想的对称形式。

一个信道的转移概率矩阵 $P$，满足：
1. 每一行都是其他行的置换。
2.  每一列都是其他列的置换。

（即不需要划分子集，整个矩阵本身就是均匀的）。

也就是：每一行的元素都相同，每一列的元素也完全相同。

**例子**：
$$
\begin{bmatrix} 0.3 & 0.2 & 0.5 \\ 0.5 & 0.3 & 0.2 \\ 0.2 & 0.5 & 0.3 \end{bmatrix} 
$$
每一列的和都是 1.0，每一列的成分都是 $\{0.2, 0.3, 0.5\}$。这是强对称信道。

**二者区别**：

*   **强对称信道**：每一列长得都一样（成分相同），大家地位完全平等。
*   **对称信道**：列可以长得不一样，但长得一样的必须抱团（分组），且每团内部是平等的。

#### **3. 对称信道的判别准则**

**在矩阵满足行对称的情况下**：

1. 如果每一列的元素相同，且每列之和 $y_1,...,y_n$ 相等，那么它就是强对称信道
2. 如果不完全相等，那么按列进行子集划分，确保每个子集里，每列的元素和列元素之和相等。
3. 如果每一列的元素都不同，即$y_1 \neq y_2 \neq ... \neq y_n$，那么将该信道划分为 $n$ 个子集，在每个子集里查看行置换是否成立，不成立则为不对称信道

#### **4. 信道容量计算公式**

![30](./30.jpg)

### 3.5. 三个容量计算公式的区分

**信道容量计算原始公式**：
$$
C = \max_{p(x)} I(X;Y) = \max_{p(x)} [H(Y) - H(Y|X)] 
$$

**1. 离散无噪声信道容量**：
$$
C = log_2\ min(r,s)(bit/symbol)
$$

> $r$ 为转移矩阵的行数，代表输入符号集的大小。（信道输入端有多少种可能的符号）
>
> $s$ 为转移矩阵的列数，代表输出符号集的大小（信道输出端有多少种可能的符号）。
>
> 例：
> $$
> P =
> \begin{pmatrix}
> 1/3 & 1/3 & 1/6 & 1/6 \\
> 1/6 & 1/3 & 1/6 & 1/3
> \end{pmatrix}
> $$
> $r = 2，s = 4$

这是最特殊的情况，因为此时信道**无噪声**。因为无噪声，条件熵（噪声熵）$H(Y|X) = 0$，此时 $C = \max H(Y)$。如果没有噪声，信道容量仅受限于输入符号个数 $r$ 或输出符号个数 $s$ 中较小的那个瓶颈

这是公式 2 和 3 在“噪声项为 0”且“信道结构特殊”时的极限情况

**2. 离散对称信道容量**：

$$
C = H(Y) - H(p_{1}, p_{2}, \dots, p_{s})
$$
较一般的情况：信道广义对称时（行是对称的，列可分子集对称）。
- 对于噪声熵 $H(Y|X)$：依然等于任意一行的熵 $H(\text{row})$（因为行是置换）
- 对于输出熵 $H(Y)$：对于准对称信道，输入等概时，输出**并不一定是均匀分布**。所以 $H(Y)$ 不等于 $\log s$，必须具体计算：带入当输入等概时，输出 $Y$ 的边缘分布，进而求出 $H(Y)$。

**3. 离散强对称信道容量**：

$$
C = \log s - H(p_{1}, p_{2}, \dots, p_{s}) 
$$
这是对称信道里的**特殊情况**：强对称。
- 输出熵 $H(Y)$：由于强对称性，当输入等概时，输出也是严格等概的（均匀分布）。因此最大输出熵固定为 $\log s$（$s$ 是输出符号数）
- 噪声熵 $H(Y|X)$：等于任意一行的熵 $H(\text{row})$

#### **总结**

公式逻辑链：

*   **所有信道**：$C = \max [H(Y) - H(Y|X)]$
    *   $\downarrow$ 如果 行是置换（对称/准对称）
    *   **公式 B**：$C = H(Y)_{\text{输入等概}} - H(\text{row})$
        *   $\downarrow$ 如果 列也是置换（强对称）
        *   **公式 C**：$C = \log s - H(\text{row})$
            *   $\downarrow$ 如果 矩阵里只有 0 和 1（无噪）
            *   **公式 A**：$C = \log \min(r, s)$ （此时 $H(\text{row})=0$）

所以说记住第一个公式（公式 B）即可。

### 例题

![31](./31.jpg)

![32](./32.jpg)

$q_1, q_2, q_3, q_4$ 为**信道的输出概率**，即 $P(Y=y_j)$。

*对于（准）对称信道，当输入概率分布为等概分布（即均匀分布）时，互信息 $I(X;Y)$ 达到最大值，即达到信道容量。*

**输入概率**：因为矩阵有 2 行，所以输入 $X$ 有 2 个符号。为了达到容量，设输入等概：
$$
P(x_1) = P(x_2) = \frac{1}{2} 
$$

**转移概率**：即矩阵中的元素 $P(y_j | x_i)$。

$q_1$（输出第 1 列符号的概率）的完整计算过程：
$$
\begin{aligned}
P(Y=y_1) &= \sum_{i} P(X=x_i) P(Y=y_1 | X=x_i) \\
&= P(x_1) P(y_1 | x_1) + P(x_2) P(y_1 | x_2) \\
&= \frac{1}{2} \times \frac{1}{3} + \frac{1}{2} \times \frac{1}{6} \\
&= \frac{1}{2} \left( \frac{1}{3} + \frac{1}{6} \right) \quad \leftarrow \text{这就是书上的算式}
\end{aligned}
$$

## 4. 信道级联

### 4.1. 定义

![33](./33.jpg)

**解读**：

由定理 6.3：

**前提**：$X \to Y \to Z$ 构成马尔可夫链，因此 $Z$ 的状态只取决于 $Y$，一旦 $Y$ 确定了，Z 就与 $X$ 统计独立。数学上表示为 $P(z|y,x) = P(z|y)$。
$$
I(X;Z) \leq I(X;Y)\\
I(X;Z) \leq I(Y;Z)
$$

意思是：在一个级联系统中，首尾两端（$X$ 和 $Z$）之间的互信息，绝不会超过中间任意一环（例如 $X$ 和 $Y$，或者 $Y$ 和 $Z$）之间的互信息。

**无差错传输问题**：能否通过某种方式完全恢复原始信号 $X$，即达到 $I(X; Z) = H(X)$ 的状态。

根据定理 6.3，结论是：

如果第一个信道 $X \to Y$ 是有噪声的（即存在信息丢失），使得：
$$
I(X; Y) < H(X)
$$
那么根据定理 $I(X; Z) \leq I(X; Y)$，必然有：
$$
I(X; Z) < H(X)
$$
也就是说，如果第一级信道已经破坏了信息，后续无论连接多少个信道，或者接收端进行多么复杂的信号处理（$Y \to Z$），都永远无法实现无差错传输（无法完全恢复 $X$）。

**即如果级联信道里存在噪声，那么就不可能实现无差错传输**。（只要信道的转移矩阵符号集不是 $\{0, 1\}$）

### 4.2. 级联信道转移概率矩阵的计算

级联信道既然为马氏链，一级级联相当于状态的一步转移。因此，级联信道的转移概率矩阵为级联信道中各矩阵依次相乘。

根据级联信道的转移矩阵特点，按照前面介绍的离散信道容量的计算方法即可计算其信道容量。

![33](./34.jpg)

![35](./35.jpg)

**结论**：信道串联后增加信息损失，串联级数越多，损失越大。

![36](./36.jpg)

